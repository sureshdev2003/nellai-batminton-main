<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>JavaScript Functionality Test</h1>
    
    <div class="test-section">
        <h3>Test 1: Time Dropdown</h3>
        <label for="timeSlot">Select Time:</label>
        <select id="timeSlot">
            <option value="">Choose a time slot</option>
            <option value="10:00">10:00 AM - 11:00 AM</option>
            <option value="11:00">11:00 AM - 12:00 PM</option>
        </select>
        <div id="testResult"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 2: API Call</h3>
        <button onclick="testAPI()">Test API Call</button>
        <div id="apiResult"></div>
    </div>
    
    <div class="test-section">
        <h3>Test 3: Fallback Function</h3>
        <button onclick="testFallback()">Test Fallback</button>
        <div id="fallbackResult"></div>
    </div>

    <script>
        // Test 1: Time Dropdown
        document.addEventListener('DOMContentLoaded', function() {
            const timeDropdown = document.getElementById('timeSlot');
            const testResult = document.getElementById('testResult');
            
            if (timeDropdown) {
                testResult.innerHTML = '<span class="success">✅ Time dropdown found</span>';
                
                timeDropdown.addEventListener('change', function() {
                    const selectedTime = this.value;
                    testResult.innerHTML = `<span class="info">Selected time: ${selectedTime}</span>`;
                });
            } else {
                testResult.innerHTML = '<span class="error">❌ Time dropdown not found</span>';
            }
        });
        
        // Test 2: API Call
        function testAPI() {
            const apiResult = document.getElementById('apiResult');
            const time = '10:00';
            const date = new Date().toISOString().split('T')[0];
            
            apiResult.innerHTML = '<span class="info">Testing API call...</span>';
            
            fetch(`check_slot_availability.php?time=${time}&date=${date}`)
                .then(response => {
                    console.log('Response status:', response.status);
                    return response.json();
                })
                .then(data => {
                    console.log('API response:', data);
                    if (data.success) {
                        apiResult.innerHTML = '<span class="success">✅ API call successful</span>';
                        apiResult.innerHTML += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                    } else {
                        apiResult.innerHTML = '<span class="error">❌ API error: ' + (data.error || 'Unknown error') + '</span>';
                    }
                })
                .catch(error => {
                    console.error('Fetch error:', error);
                    apiResult.innerHTML = '<span class="error">❌ Fetch error: ' + error.message + '</span>';
                });
        }
        
        // Test 3: Fallback Function
        function testFallback() {
            const fallbackResult = document.getElementById('fallbackResult');
            const selectedTime = '10:00';
            
            // Simulate fallback availability check
            const courts = [
                { court: 1, available: true, members: 4 },
                { court: 2, available: true, members: 6 },
                { court: 3, available: false, members: 0 },
                { court: 4, available: true, members: 2 }
            ];
            
            let result = '<span class="success">✅ Fallback function working</span><br>';
            courts.forEach(court => {
                const status = court.available ? 'Available' : 'Full';
                const color = court.available ? 'green' : 'red';
                result += `<span style="color: ${color}">Court ${court.court}: ${status} (${court.members}/6 members)</span><br>`;
            });
            
            fallbackResult.innerHTML = result;
        }
    </script>
</body>
</html>
